<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>De Rijkste Belgen â€” Lead Wiki</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Inter', 'system-ui', 'sans-serif'] },
        }
      }
    }
  </script>
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Inter', system-ui, sans-serif; background: #0f172a; color: #e2e8f0; min-height: 100vh; }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 5px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }

    /* Sidebar */
    .sidebar { background: #1e293b; border-right: 1px solid #334155; width: 280px; min-width: 280px; }
    .sidebar-link { display: flex; align-items: center; gap: 8px; padding: 6px 12px; border-radius: 6px; font-size: 0.8125rem; color: #94a3b8; transition: all 120ms; cursor: pointer; }
    .sidebar-link:hover { background: #334155; color: #e2e8f0; }
    .sidebar-link.active { background: #0ea5e9; color: white; }

    /* Cards */
    .card { background: #1e293b; border: 1px solid #334155; border-radius: 0.75rem; }
    .card-hover:hover { border-color: #475569; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }

    /* Wiki link */
    .wiki-link { color: #38bdf8; text-decoration: none; cursor: pointer; transition: color 120ms; }
    .wiki-link:hover { color: #7dd3fc; text-decoration: underline; }

    /* Badges */
    .badge { display: inline-flex; align-items: center; padding: 2px 8px; border-radius: 9999px; font-size: 0.6875rem; font-weight: 600; letter-spacing: 0.02em; }
    .badge-family { background: #312e81; color: #a5b4fc; }
    .badge-company { background: #4c1d95; color: #c4b5fd; }
    .badge-person { background: #064e3b; color: #6ee7b7; }
    .badge-wealth { background: #78350f; color: #fcd34d; }

    /* Pill links */
    .pill { display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 9999px; font-size: 0.75rem; font-weight: 500; text-decoration: none; transition: all 120ms; }
    .pill-linkedin { background: #1e3a5f; color: #60a5fa; }
    .pill-linkedin:hover { background: #1e40af; }
    .pill-email { background: #064e3b; color: #6ee7b7; }
    .pill-email:hover { background: #065f46; }
    .pill-web { background: #3f3f46; color: #d4d4d8; }
    .pill-web:hover { background: #52525b; }

    /* Entity cards in grid */
    .entity-card { transition: all 150ms; cursor: pointer; }
    .entity-card:hover { transform: translateY(-2px); border-color: #475569; }

    /* Stat pills */
    .stat-pill { background: linear-gradient(135deg, #0ea5e9, #0369a1); padding: 2px 10px; border-radius: 999px; font-size: 0.75rem; font-weight: 700; color: white; }

    /* Search */
    .search-box { background: #1e293b; border: 1px solid #334155; transition: border-color 150ms, box-shadow 150ms; }
    .search-box:focus { border-color: #0ea5e9; box-shadow: 0 0 0 3px rgba(14,165,233,0.2); outline: none; }

    /* Fade in */
    .fade-in { animation: fadeIn 250ms ease-out; }
    @keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

    /* Table */
    .wiki-table { width: 100%; }
    .wiki-table th { text-align: left; padding: 8px 12px; font-size: 0.6875rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; color: #64748b; border-bottom: 1px solid #334155; }
    .wiki-table td { padding: 8px 12px; font-size: 0.8125rem; border-bottom: 1px solid #1e293b; }
    .wiki-table tr:hover td { background: #1e293b; }

    /* Mobile */
    @media (max-width: 768px) {
      .sidebar { display: none; }
      .sidebar.open { display: flex; position: fixed; top: 0; left: 0; bottom: 0; z-index: 100; }
    }

    /* Section headers */
    .section-label { font-size: 0.625rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: #475569; padding: 0 12px; margin-bottom: 4px; margin-top: 16px; }
  </style>
</head>
<body>

<div class="flex min-h-screen">

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar flex flex-col h-screen sticky top-0 overflow-hidden">
    <!-- Header -->
    <div class="p-4 border-b border-[#334155]">
      <div class="flex items-center gap-2 mb-3">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-sky-500 to-blue-700 flex items-center justify-center text-white font-bold text-xs">RB</div>
        <div>
          <h1 class="text-sm font-bold text-white leading-tight">Rijkste Belgen</h1>
          <p class="text-[10px] text-slate-400">Lead Wiki â€” VibeLab</p>
        </div>
      </div>
      <input id="sidebarSearch" type="text" placeholder="Searchâ€¦" class="search-box w-full rounded-lg px-3 py-1.5 text-sm text-slate-200" />
    </div>

    <!-- Nav -->
    <nav id="sidebarNav" class="flex-1 overflow-y-auto p-2">
      <!-- Populated by JS -->
    </nav>

    <!-- Stats footer -->
    <div class="p-3 border-t border-[#334155] text-[10px] text-slate-500 flex gap-3">
      <span id="sFam">â€”</span>
      <span id="sComp">â€”</span>
      <span id="sPpl">â€”</span>
    </div>
  </aside>

  <!-- Main -->
  <main class="flex-1 min-w-0">
    <!-- Top bar (mobile) -->
    <div class="md:hidden sticky top-0 z-50 bg-[#0f172a] border-b border-[#334155] px-4 py-3 flex items-center gap-3">
      <button id="menuBtn" class="text-slate-400 hover:text-white"><i data-lucide="menu" class="w-5 h-5"></i></button>
      <input id="topSearch" type="text" placeholder="Searchâ€¦" class="search-box flex-1 rounded-lg px-3 py-1.5 text-sm text-slate-200" />
    </div>

    <div id="mainContent" class="p-4 sm:p-6 max-w-[1100px] mx-auto fade-in">
      <!-- Rendered by JS -->
    </div>
  </main>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA & STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let G = { families:[], companies:[], people:[] };
let IDX = { families:{}, companies:{}, people:{} };
let STATE = { view:'home', id:null };

async function boot() {
  const d = await fetch('data/graph.json').then(r=>r.json());
  G = d;
  G.families.forEach(f => IDX.families[f.id] = f);
  G.companies.forEach(c => IDX.companies[c.id] = c);
  G.people.forEach(p => IDX.people[p.id] = p);

  document.getElementById('sFam').textContent = G.families.length + ' families';
  document.getElementById('sComp').textContent = G.companies.length + ' companies';
  document.getElementById('sPpl').textContent = G.people.length + ' people';

  // Handle hash routing
  window.addEventListener('hashchange', route);
  route();
  buildSidebar();
}

function route() {
  const h = location.hash.slice(1);
  if (!h) { STATE = {view:'home', id:null}; }
  else if (h === 'families') { STATE = {view:'list', type:'families'}; }
  else if (h === 'companies') { STATE = {view:'list', type:'companies'}; }
  else if (h === 'people') { STATE = {view:'list', type:'people'}; }
  else if (h.startsWith('family/')) { STATE = {view:'family', id:h.slice(7)}; }
  else if (h.startsWith('company/')) { STATE = {view:'company', id:h.slice(8)}; }
  else if (h.startsWith('person/')) { STATE = {view:'person', id:h.slice(7)}; }
  else { STATE = {view:'home'}; }
  render();
  updateSidebarActive();
}

function nav(hash) { location.hash = hash; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SIDEBAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function buildSidebar(filter='') {
  const el = document.getElementById('sidebarNav');
  const q = filter.toLowerCase();
  let html = '';

  // Home
  html += `<div class="sidebar-link ${STATE.view==='home'?'active':''}" onclick="nav('')">
    <i data-lucide="home" class="w-4 h-4"></i> Home
  </div>`;

  // Families section
  html += `<div class="section-label">Families (${G.families.length})</div>`;
  html += `<div class="sidebar-link" onclick="nav('families')"><i data-lucide="crown" class="w-4 h-4"></i> All Families</div>`;
  const fams = q ? G.families.filter(f => f.name.toLowerCase().includes(q)) : G.families.slice(0, 30);
  fams.forEach(f => {
    const active = STATE.view==='family' && STATE.id===f.id;
    html += `<div class="sidebar-link ${active?'active':''}" onclick="nav('family/${f.id}')">
      <span class="truncate">#${f.rank} ${f.name}</span>
    </div>`;
  });
  if (!q && G.families.length > 30) html += `<div class="sidebar-link text-slate-500" onclick="nav('families')">+ ${G.families.length - 30} moreâ€¦</div>`;

  // Companies section
  html += `<div class="section-label">Companies (${G.companies.length})</div>`;
  html += `<div class="sidebar-link" onclick="nav('companies')"><i data-lucide="building-2" class="w-4 h-4"></i> All Companies</div>`;
  const comps = q ? G.companies.filter(c => c.name.toLowerCase().includes(q)).slice(0, 30) : G.companies.slice(0, 15);
  comps.forEach(c => {
    const active = STATE.view==='company' && STATE.id===c.id;
    html += `<div class="sidebar-link ${active?'active':''}" onclick="nav('company/${c.id}')">
      <span class="truncate">${c.name}</span>
    </div>`;
  });

  // People section
  html += `<div class="section-label">People (${G.people.length})</div>`;
  html += `<div class="sidebar-link" onclick="nav('people')"><i data-lucide="users" class="w-4 h-4"></i> All People</div>`;
  const ppls = q ? G.people.filter(p => p.name.toLowerCase().includes(q)).slice(0, 30) : G.people.slice(0, 15);
  ppls.forEach(p => {
    const active = STATE.view==='person' && STATE.id===p.id;
    html += `<div class="sidebar-link ${active?'active':''}" onclick="nav('person/${p.id}')">
      <span class="truncate">${p.name}</span>
    </div>`;
  });

  el.innerHTML = html;
  lucide.createIcons();
}

function updateSidebarActive() { buildSidebar(document.getElementById('sidebarSearch').value); }

document.getElementById('sidebarSearch').addEventListener('input', e => buildSidebar(e.target.value));
document.getElementById('menuBtn')?.addEventListener('click', () => document.getElementById('sidebar').classList.toggle('open'));

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render() {
  const el = document.getElementById('mainContent');
  el.classList.remove('fade-in');
  void el.offsetWidth;
  el.classList.add('fade-in');

  if (STATE.view === 'home') el.innerHTML = renderHome();
  else if (STATE.view === 'list') el.innerHTML = renderList(STATE.type);
  else if (STATE.view === 'family') el.innerHTML = renderFamily(STATE.id);
  else if (STATE.view === 'company') el.innerHTML = renderCompany(STATE.id);
  else if (STATE.view === 'person') el.innerHTML = renderPerson(STATE.id);
  else el.innerHTML = '<div class="text-center py-20 text-slate-400">Page not found</div>';

  lucide.createIcons();
  window.scrollTo(0, 0);
}

// â”€â”€ Helpers â”€â”€
function parseWealth(s) { return parseFloat((s||'').replace(/\./g,'').replace(',','.')) || 0; }
function fmtWealth(n) {
  if (n >= 1e9) return 'â‚¬' + (n/1e9).toFixed(1) + 'B';
  if (n >= 1e6) return 'â‚¬' + (n/1e6).toFixed(0) + 'M';
  return 'â‚¬' + n.toLocaleString();
}
function famLink(id) { const f = IDX.families[id]; return f ? `<a class="wiki-link" onclick="nav('family/${id}')">${f.name}</a>` : id; }
function compLink(id) { const c = IDX.companies[id]; return c ? `<a class="wiki-link" onclick="nav('company/${id}')">${c.name}</a>` : id; }
function personLink(id) { const p = IDX.people[id]; return p ? `<a class="wiki-link" onclick="nav('person/${id}')">${p.name}</a>` : id; }
function liPill(url) { return url ? `<a href="${url}" target="_blank" class="pill pill-linkedin"><i data-lucide="linkedin" class="w-3 h-3"></i>LinkedIn</a>` : ''; }
function emailPill(e) { return e ? `<a href="mailto:${e}" class="pill pill-email"><i data-lucide="mail" class="w-3 h-3"></i>${e}</a>` : ''; }
function webPill(u) { return u ? `<a href="${u}" target="_blank" class="pill pill-web"><i data-lucide="globe" class="w-3 h-3"></i>Website</a>` : ''; }
function extPill(u, label) { return u ? `<a href="${u}" target="_blank" class="pill pill-web"><i data-lucide="external-link" class="w-3 h-3"></i>${label}</a>` : ''; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// HOME
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderHome() {
  const topFamilies = G.families.slice(0, 10);
  const topPeople = G.people.filter(p=>p.email).slice(0, 8);

  return `
    <div class="mb-8">
      <h1 class="text-3xl font-extrabold text-white mb-2">De Rijkste Belgen</h1>
      <p class="text-slate-400">Interactive lead wiki â€” ${G.families.length} families Â· ${G.companies.length} companies Â· ${G.people.length} contacts</p>
    </div>

    <!-- Stats -->
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8">
      <div class="card p-5 cursor-pointer card-hover" onclick="nav('families')">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-indigo-500/20 flex items-center justify-center"><i data-lucide="crown" class="w-5 h-5 text-indigo-400"></i></div>
          <div>
            <p class="text-2xl font-extrabold text-white">${G.families.length}</p>
            <p class="text-xs text-slate-400">Families</p>
          </div>
        </div>
      </div>
      <div class="card p-5 cursor-pointer card-hover" onclick="nav('companies')">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-purple-500/20 flex items-center justify-center"><i data-lucide="building-2" class="w-5 h-5 text-purple-400"></i></div>
          <div>
            <p class="text-2xl font-extrabold text-white">${G.companies.length}</p>
            <p class="text-xs text-slate-400">Companies</p>
          </div>
        </div>
      </div>
      <div class="card p-5 cursor-pointer card-hover" onclick="nav('people')">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-lg bg-emerald-500/20 flex items-center justify-center"><i data-lucide="users" class="w-5 h-5 text-emerald-400"></i></div>
          <div>
            <p class="text-2xl font-extrabold text-white">${G.people.length}</p>
            <p class="text-xs text-slate-400">Contacts w/ email</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Top Families -->
    <h2 class="text-lg font-bold text-white mb-3">ğŸ‘‘ Top 10 Wealthiest</h2>
    <div class="card overflow-hidden mb-8">
      <table class="wiki-table">
        <thead><tr><th>#</th><th>Family</th><th>Wealth</th><th>Companies</th><th>Contacts</th></tr></thead>
        <tbody>
          ${topFamilies.map(f => `
            <tr class="cursor-pointer" onclick="nav('family/${f.id}')">
              <td class="font-mono text-slate-500">${f.rank}</td>
              <td><span class="wiki-link font-semibold">${f.name}</span><br><span class="text-xs text-slate-500">${f.location}</span></td>
              <td><span class="badge badge-wealth">${fmtWealth(parseWealth(f.wealth))}</span></td>
              <td><span class="badge badge-company">${f.companyIds.length}</span></td>
              <td><span class="badge badge-person">${f.personIds.length}</span></td>
            </tr>
          `).join('')}
        </tbody>
      </table>
    </div>

    <!-- Recent contacts -->
    <h2 class="text-lg font-bold text-white mb-3">ğŸ“§ Recent Contacts</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
      ${topPeople.map(p => `
        <div class="card p-4 entity-card card-hover" onclick="nav('person/${p.id}')">
          <div class="font-semibold text-white text-sm">${p.name}</div>
          <div class="text-xs text-slate-400 mt-0.5">${p.role || 'N/A'} Â· ${p.company || ''}</div>
          <div class="flex flex-wrap gap-1.5 mt-2">
            ${liPill(p.linkedin)}
            ${emailPill(p.email)}
          </div>
        </div>
      `).join('')}
    </div>
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// LIST VIEWS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderList(type) {
  const titles = { families:'ğŸ‘‘ All Families', companies:'ğŸ¢ All Companies', people:'ğŸ‘¤ All People' };
  let html = `
    <div class="flex items-center justify-between mb-4">
      <h1 class="text-2xl font-bold text-white">${titles[type]}</h1>
      <input id="listSearch" type="text" placeholder="Filterâ€¦" class="search-box rounded-lg px-3 py-1.5 text-sm text-slate-200 w-60" oninput="filterList('${type}')">
    </div>
    <div id="listBody"></div>
  `;
  setTimeout(() => filterList(type), 0);
  return html;
}

function filterList(type) {
  const q = (document.getElementById('listSearch')?.value || '').toLowerCase();
  const el = document.getElementById('listBody');
  if (!el) return;

  if (type === 'families') {
    let items = G.families.filter(f => !q || f.name.toLowerCase().includes(q) || (f.summary||'').toLowerCase().includes(q));
    el.innerHTML = `
      <div class="card overflow-hidden">
        <table class="wiki-table">
          <thead><tr><th>#</th><th>Family</th><th>Location</th><th>Wealth</th><th>Companies</th><th>Contacts</th></tr></thead>
          <tbody>${items.slice(0,200).map(f => `
            <tr class="cursor-pointer" onclick="nav('family/${f.id}')">
              <td class="font-mono text-slate-500 text-xs">${f.rank}</td>
              <td><span class="wiki-link">${f.name}</span></td>
              <td class="text-slate-400 text-xs">${f.location}</td>
              <td><span class="badge badge-wealth">${fmtWealth(parseWealth(f.wealth))}</span></td>
              <td class="text-center"><span class="badge badge-company">${f.companyIds.length}</span></td>
              <td class="text-center"><span class="badge badge-person">${f.personIds.length}</span></td>
            </tr>
          `).join('')}</tbody>
        </table>
        <div class="p-2 text-center text-xs text-slate-500">${items.length} results${items.length>200?' (showing 200)':''}</div>
      </div>`;
  } else if (type === 'companies') {
    let items = G.companies.filter(c => !q || c.name.toLowerCase().includes(q));
    el.innerHTML = `
      <div class="card overflow-hidden">
        <table class="wiki-table">
          <thead><tr><th>Company</th><th>Families</th><th>People</th><th>Links</th></tr></thead>
          <tbody>${items.slice(0,300).map(c => `
            <tr class="cursor-pointer" onclick="nav('company/${c.id}')">
              <td><span class="wiki-link font-semibold">${c.name}</span></td>
              <td>${c.familyIds.slice(0,3).map(fid => `<span class="badge badge-family mr-1">${(IDX.families[fid]||{}).name||fid}</span>`).join('')}</td>
              <td class="text-center"><span class="badge badge-person">${c.personIds.length}</span></td>
              <td>${liPill(c.linkedin)} ${webPill(c.website)}</td>
            </tr>
          `).join('')}</tbody>
        </table>
        <div class="p-2 text-center text-xs text-slate-500">${items.length} results${items.length>300?' (showing 300)':''}</div>
      </div>`;
  } else {
    let items = G.people.filter(p => !q || p.name.toLowerCase().includes(q) || (p.company||'').toLowerCase().includes(q) || (p.role||'').toLowerCase().includes(q));
    el.innerHTML = `
      <div class="card overflow-hidden">
        <table class="wiki-table">
          <thead><tr><th>Person</th><th>Role</th><th>Company</th><th>LinkedIn</th><th>Email</th></tr></thead>
          <tbody>${items.slice(0,300).map(p => `
            <tr class="cursor-pointer" onclick="nav('person/${p.id}')">
              <td><span class="wiki-link font-semibold">${p.name}</span></td>
              <td class="text-slate-400 text-xs">${p.role||'â€”'}</td>
              <td class="text-slate-400 text-xs">${p.company||'â€”'}</td>
              <td>${liPill(p.linkedin)}</td>
              <td>${emailPill(p.email)}</td>
            </tr>
          `).join('')}</tbody>
        </table>
        <div class="p-2 text-center text-xs text-slate-500">${items.length} results${items.length>300?' (showing 300)':''}</div>
      </div>`;
  }
  lucide.createIcons();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DETAIL: FAMILY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderFamily(id) {
  const f = IDX.families[id];
  if (!f) return '<div class="py-20 text-center text-slate-400">Family not found</div>';

  const wealth = parseWealth(f.wealth);
  const companies = f.companyIds.map(cid => IDX.companies[cid]).filter(Boolean);
  const people = f.personIds.map(pid => IDX.people[pid]).filter(Boolean);

  return `
    <nav class="text-xs text-slate-500 mb-4">
      <a class="wiki-link" onclick="nav('')">Home</a> / 
      <a class="wiki-link" onclick="nav('families')">Families</a> / 
      <span class="text-slate-300">${f.name}</span>
    </nav>

    <div class="card p-6 mb-6">
      <div class="flex flex-wrap items-start justify-between gap-4">
        <div>
          <span class="badge badge-wealth mb-2">Rank #${f.rank}</span>
          <h1 class="text-2xl font-extrabold text-white mt-1">${f.name}</h1>
          <p class="text-sm text-slate-400 mt-1">${f.location}</p>
        </div>
        <div class="text-right">
          <p class="text-3xl font-extrabold text-amber-400">${fmtWealth(wealth)}</p>
          <p class="text-xs text-slate-500">Estimated wealth</p>
        </div>
      </div>
      ${f.summary ? `<p class="text-sm text-slate-300 mt-4 leading-relaxed border-l-2 border-sky-600 pl-4">${f.summary}</p>` : ''}
      ${f.familyMembers ? `<p class="text-xs text-slate-400 mt-3"><strong class="text-slate-300">Family members:</strong> ${f.familyMembers}</p>` : ''}
      <div class="flex flex-wrap gap-2 mt-4">
        ${extPill(f.profileUrl, 'Source profile')}
      </div>
    </div>

    <!-- Companies -->
    <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
      <i data-lucide="building-2" class="w-5 h-5 text-purple-400"></i>
      Companies (${companies.length})
    </h2>
    ${companies.length ? `
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 mb-8">
        ${companies.map(c => `
          <div class="card p-4 entity-card card-hover" onclick="nav('company/${c.id}')">
            <div class="font-semibold text-white text-sm">${c.name}</div>
            ${c.industry ? `<div class="text-xs text-slate-400 mt-0.5">${c.industry}</div>` : ''}
            <div class="flex flex-wrap gap-1 mt-2">
              ${liPill(c.linkedin)} ${webPill(c.website)}
              <span class="badge badge-person">${c.personIds.length} contacts</span>
            </div>
          </div>
        `).join('')}
      </div>
    ` : '<div class="card p-4 mb-8 text-slate-500 text-sm">No companies linked yet.</div>'}

    <!-- People -->
    <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
      <i data-lucide="users" class="w-5 h-5 text-emerald-400"></i>
      People (${people.length})
    </h2>
    ${people.length ? `
      <div class="card overflow-hidden mb-8">
        <table class="wiki-table">
          <thead><tr><th>Person</th><th>Role</th><th>Company</th><th>LinkedIn</th><th>Email</th></tr></thead>
          <tbody>${people.map(p => `
            <tr class="cursor-pointer" onclick="nav('person/${p.id}')">
              <td><span class="wiki-link font-semibold">${p.name}</span></td>
              <td class="text-slate-400 text-xs">${p.role||'â€”'}</td>
              <td class="text-slate-400 text-xs">${p.company||'â€”'}</td>
              <td>${liPill(p.linkedin)}</td>
              <td>${emailPill(p.email)}</td>
            </tr>
          `).join('')}</tbody>
        </table>
      </div>
    ` : '<div class="card p-4 mb-8 text-slate-500 text-sm">No contacts linked yet.</div>'}
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DETAIL: COMPANY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderCompany(id) {
  const c = IDX.companies[id];
  if (!c) return '<div class="py-20 text-center text-slate-400">Company not found</div>';

  const fams = c.familyIds.map(fid => IDX.families[fid]).filter(Boolean);
  const people = c.personIds.map(pid => IDX.people[pid]).filter(Boolean);

  return `
    <nav class="text-xs text-slate-500 mb-4">
      <a class="wiki-link" onclick="nav('')">Home</a> / 
      <a class="wiki-link" onclick="nav('companies')">Companies</a> / 
      <span class="text-slate-300">${c.name}</span>
    </nav>

    <div class="card p-6 mb-6">
      <h1 class="text-2xl font-extrabold text-white">${c.name}</h1>
      ${c.industry ? `<p class="text-sm text-slate-400 mt-1">${c.industry}</p>` : ''}
      ${c.hq ? `<p class="text-xs text-slate-500 mt-1">HQ: ${c.hq}</p>` : ''}
      ${c.employees ? `<p class="text-xs text-slate-500">Employees: ${c.employees}</p>` : ''}
      <div class="flex flex-wrap gap-2 mt-4">
        ${liPill(c.linkedin)} ${webPill(c.website)} ${extPill(c.evidence, 'Source')}
      </div>
    </div>

    <!-- Linked Families -->
    <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
      <i data-lucide="crown" class="w-5 h-5 text-indigo-400"></i>
      Owner Families (${fams.length})
    </h2>
    ${fams.length ? `
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-8">
        ${fams.map(f => `
          <div class="card p-4 entity-card card-hover" onclick="nav('family/${f.id}')">
            <div class="flex items-center gap-2">
              <span class="badge badge-wealth">#${f.rank}</span>
              <span class="font-semibold text-white text-sm">${f.name}</span>
            </div>
            <div class="text-xs text-slate-400 mt-1">${fmtWealth(parseWealth(f.wealth))} Â· ${f.location}</div>
          </div>
        `).join('')}
      </div>
    ` : '<div class="card p-4 mb-8 text-slate-500 text-sm">No families linked.</div>'}

    <!-- People at this company -->
    <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
      <i data-lucide="users" class="w-5 h-5 text-emerald-400"></i>
      Contacts (${people.length})
    </h2>
    ${people.length ? `
      <div class="card overflow-hidden mb-8">
        <table class="wiki-table">
          <thead><tr><th>Person</th><th>Role</th><th>LinkedIn</th><th>Email</th></tr></thead>
          <tbody>${people.map(p => `
            <tr class="cursor-pointer" onclick="nav('person/${p.id}')">
              <td><span class="wiki-link font-semibold">${p.name}</span></td>
              <td class="text-slate-400 text-xs">${p.role||'â€”'}</td>
              <td>${liPill(p.linkedin)}</td>
              <td>${emailPill(p.email)}</td>
            </tr>
          `).join('')}</tbody>
        </table>
      </div>
    ` : '<div class="card p-4 mb-8 text-slate-500 text-sm">No contacts found yet.</div>'}
  `;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DETAIL: PERSON
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderPerson(id) {
  const p = IDX.people[id];
  if (!p) return '<div class="py-20 text-center text-slate-400">Person not found</div>';

  const fams = p.familyIds.map(fid => IDX.families[fid]).filter(Boolean);
  const comps = p.companyIds.map(cid => IDX.companies[cid]).filter(Boolean);

  return `
    <nav class="text-xs text-slate-500 mb-4">
      <a class="wiki-link" onclick="nav('')">Home</a> / 
      <a class="wiki-link" onclick="nav('people')">People</a> / 
      <span class="text-slate-300">${p.name}</span>
    </nav>

    <div class="card p-6 mb-6">
      <h1 class="text-2xl font-extrabold text-white">${p.name}</h1>
      ${p.role ? `<p class="text-sm text-slate-400 mt-1">${p.role}</p>` : ''}
      ${p.company ? `<p class="text-xs text-slate-500 mt-1">@ ${p.company}</p>` : ''}
      <div class="flex flex-wrap gap-2 mt-4">
        ${liPill(p.linkedin)}
        ${emailPill(p.email)}
      </div>
    </div>

    <!-- Linked Families -->
    ${fams.length ? `
      <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
        <i data-lucide="crown" class="w-5 h-5 text-indigo-400"></i>
        Connected Families (${fams.length})
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-8">
        ${fams.map(f => `
          <div class="card p-4 entity-card card-hover" onclick="nav('family/${f.id}')">
            <div class="flex items-center gap-2">
              <span class="badge badge-wealth">#${f.rank}</span>
              <span class="font-semibold text-white text-sm">${f.name}</span>
            </div>
            <div class="text-xs text-slate-400 mt-1">${fmtWealth(parseWealth(f.wealth))} Â· ${f.location}</div>
          </div>
        `).join('')}
      </div>
    ` : ''}

    <!-- Linked Companies -->
    ${comps.length ? `
      <h2 class="text-lg font-bold text-white mb-3 flex items-center gap-2">
        <i data-lucide="building-2" class="w-5 h-5 text-purple-400"></i>
        Companies (${comps.length})
      </h2>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mb-8">
        ${comps.map(c => `
          <div class="card p-4 entity-card card-hover" onclick="nav('company/${c.id}')">
            <div class="font-semibold text-white text-sm">${c.name}</div>
            ${c.industry ? `<div class="text-xs text-slate-400 mt-0.5">${c.industry}</div>` : ''}
            <div class="flex flex-wrap gap-1 mt-2">
              ${liPill(c.linkedin)} ${webPill(c.website)}
            </div>
          </div>
        `).join('')}
      </div>
    ` : ''}
  `;
}

// Boot
boot();
</script>
</body>
</html>
